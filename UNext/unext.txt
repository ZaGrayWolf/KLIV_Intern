

    # --- UNext_S ---
    print("Calculating for UNext_S...")
    try:
        # Instantiate the simulated UNext_S model
        unext_s_model = UNext_S(num_classes=NUM_CLASSES,
                               input_channels=input_shape[1],
                               depths=unext_s_depths,
                               mlp_ratios=unext_s_mlp_ratios)
        unext_s_model.eval()

        # Count parameters
        unext_s_params = count_parameters(unext_s_model)

        # Calculate FLOPs
        unext_s_flops = calculate_manual_flops(unext_s_model, input_shape)


        print(f"UNext_S Model ({unext_s_depths=}, {unext_s_mlp_ratios=}):")
        print(f"  Input Shape: {input_shape}")
        print(f"  Parameters: {unext_s_params / 1e6:.2f} M")
        print(f"  Approx. FLOPs: {unext_s_flops / 1e9:.2f} GFLOPs")

    except Exception as e:
         print(f"An error occurred during UNext_S calculation: {e}")
         import traceback
         traceback.print_exc()
    print("-" * 30)
    
